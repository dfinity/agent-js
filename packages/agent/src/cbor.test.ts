import { Principal } from '@dfinity/principal';
import { bytesToHex, hexToBytes } from '@noble/hashes/utils';
import * as cbor from './cbor';

test('round trip', () => {
  interface Data {
    a: number;
    b: string;
    c: Uint8Array;
    d: { four: string };
    e: Principal;
    f: Uint8Array;
    g: bigint;
  }

  const input: Data = {
    a: 1,
    b: 'two',
    c: new Uint8Array([3]),
    d: { four: 'four' },
    e: Principal.fromHex('FfFfFfFfFfFfFfFfd7'),
    f: new Uint8Array([]),
    g: BigInt('0xffffffffffffffff'),
  };

  const output = cbor.decode<Data>(cbor.encode(input));

  expect(output.a).toEqual(input.a);
  expect(output.b).toEqual(input.b);
  expect(output.c).toEqual(input.c);
  expect(output.d).toEqual(input.d);
  expect(output.e).toEqual(input.e.toUint8Array());
  expect(output.f).toEqual(input.f);
  expect(output.g).toEqual(input.g);
});

test('empty canister ID', () => {
  const input: { a: Principal } = {
    a: Principal.fromText('aaaaa-aa'),
  };

  const output = cbor.decode<typeof input>(cbor.encode(input));

  const inputA = input.a;
  const outputA = output.a;

  expect(bytesToHex(outputA as unknown as Uint8Array)).toBe(inputA.toHex());
  expect(Principal.fromUint8Array(outputA as unknown as Uint8Array).toText()).toBe('aaaaa-aa');
});

test('decodes input from issue #988', () => {
  const input1 =
    'd9d9f7bf66737461747573677265706c696564657265706c79a1636172675903a84449444c2c6c02eff6bf920378999ea9b309016d026c02d6a9bbae0a788effd6e90e036b119df7d04004d1faff4306c2bac9970207fcb88b840308b0ced184030de8f8f49f040fccdbefb40411d8ba9be80412ee939c930513828eb9d10519dfabeef80a1dabe699aa0b1ef6c1a7a00c13c7b2fdf80c1fd89cda880d128daebbae0d2098e589a60e226c02bbada8a6077dc79898b70c056e716c08ae9db19001688fcac5b40171f1fee18d037dd7e3d9fe037d8ba5e18c0405bbada8a6077d92bfb9c607719fd5a3e909716c02c7c380ce0371a5c1bceb037d6c0982a6fca50309f88c88a7030adbc295da03058dfb97ee0405fe8d8ea90509c38daaa90809b1f3c3e50b09e1d887b30e0b91e396fd0f056e7d6e686e0c6b03edd29ab9037fe689d6fc037fe7f2ddcf087f6c0ba6fa9ac5010e8fd9aae20168f3eabee3017db6a9f6dc027182a6fca5037ddbc295da0371c38daaa90809cf8995cf0a05b1f3c3e50b7de1d887b30e0c91e396fd0f716b05d2bac9017fa4d3bb457fcbf2f8607f9980ded6077fb3d1cba00a7f6c01a0a3b29d06106c028fcac5b40171d7e3d9fe037d6c05fbca01688ba5e18c0405eaca8a9e0468fab2cafc0605d8a38ca80d7d6c01bbada8a6077d6c02a5c1bceb037ddec389dc04146c098e95ee8f0171f1fee18d037dded6aceb037daaac8d930415e3eb88d2067d99e7a4cf087def9999fe097dd5f8acd20a7d99e0a2ca0f166d7b6d176c02b891d40718b4e3ade809716d156c0192b6d2f00b1a6b02aca9e5840b1bb1e69dd60d1c6c01a5c1bceb037d6c01f88382797d6c06fbca01688fcac5b40105a5c1bceb037dedd2baf5037d8ba5e18c040588f2f7910e7d6c04ae9db19001688ba5e18c0405a0a3b29d0610d8a38ca80d7d6c02a0a3b29d0610c49ff4e40f716c088e95ee8f0171a287d4d0037da5c1bceb037deaca8a9e0468aaacd9d00678a2de94eb0621fab2cafc0605ca82b683097d6e156c03a5c1bceb037d97ccd4bd0623c2b9dbda0a256c068bb083237db2ceef2f248fcac5b40171c0febde20371bbada8a6077de3acdc850c7d6b02a39bfdac087faab0aea20e7f6d266c09b2ceef2f279efeb9a40371a287d4d0037da5c1bceb037deaca8a9e0468a2de94eb0621fab2cafc0605ca82b68309098e90efe40b716b04c2cde3db0a289ccae6a90e2ba4a1dfac0e7fb780f7c90f7f6b03a39bfdac0829eab6e99f0d2ac1f7a0eb0e2b6c028fcac5b401718dadc5c301096c038fcac5b40171edd2baf5037d88f2f7910e7d6c018fcac5b401710100b50b000000000000006a7369676e61747572657381a36974696d657374616d701b183326cf761ff10c697369676e617475726558400576ac71e94161129eb272ced9f2c9cdb8fc595fffc17a0e27468e4f81e059af7919cc51fdb7c39f0fcfc68de596d6cd846029c286d931f24c21d26b6aaf3e0c686964656e74697479581d24af70765c54bbf6b4ebc56cdab2864394e78740bc0a1dce631814aa02ff000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000100000008687474702f312e31d37c070000000008687474702f312e31086a070000000008687474702f312e310000000000000008687474702f312e310000002130010808687474702f312e31797d070000000008687474702f312e31797d070000000008687474702f312e310000000000000008687474702f312e31d17c070000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e315df9060000000008687474702f312e310000000000000008687474702f312e31797d070000000008687474702f312e31797d070000000008687474702f312e31d17c070000000008687474702f312e31d17c070000000008687474702f312e316f7d070000000008687474702f312e317a7d070000000008687474702f312e317a7d070000000008687474702f312e31d07c070000000008687474702f312e31707d070000000008687474702f312e317a7d070000000008687474702f312e31ffffff1200000008687474702f312e310000000000000008687474702f312e31777d070000000008687474702f312e31d07c070000000008687474702f312e31d07c070000000008687474702f312e31086a070000000008687474702f312e31d37c070000000008687474702f312e31007d070500000008687474702f312e3100000080a0000808687474702f312e31ce7c070000000008687474702f312e31ce7c070000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000200000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e31ce7c070000000008687474702f312e31ce7c070000000008687474702f312e31727d070000000008687474702f312e31727d070000000008687474702f312e31717d070000000008687474702f312e31cf7c070000000008687474702f312e31cf7c070000000008687474702f312e31cf7c070000000008687474702f312e31727d070000000008687474702f312e31cf7c070000000008687474702f312e31ffffff2200000008687474702f312e310000000000000008687474702f312e31787d070000000008687474702f312e31cf7c070000000008687474702f312e31cf7c070000000008687474702f312e31086a070000000008687474702f312e31737d070000000008687474702f312e31007c070900000008687474702f312e310000008001010808687474702f312e31cf7c070000000008687474702f312e31cf7c070000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000400000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e31cf7c070000000008687474702f312e31cf7c070000000008687474702f312e31747d070000000008687474702f312e31747d070000000008687474702f312e31737d070000000008687474702f312e31d07c070000000008687474702f312e31d07c070000000008687474702f312e31cf7c070000000008687474702f312e31747d070000000008687474702f312e31d07c070000000008687474702f312e31ffffff0a00000008687474702f312e310000000000000008687474702f312e31777d070000000008687474702f312e31cf7c070000000008687474702f312e31d07c070000000008687474702f312e31086a070000000008687474702f312e31747d070000000008687474702f312e310000000300000008687474702f312e3100000021b0000808687474702f312e31d07c070000000008687474702f312e31d07c070000000008687474702f312e310000000000000008687474702f312e31d17c070000000008687474702f312e310000000000000008687474702f312e310000000600000008687474702f312e315ff9060000000008687474702f312e310000000000000008687474702f312e31d07c070000000008687474702f312e31d07c07000000007b226d657373616765223a22556e617574686f72697a6564222c22737461747573436f6465223a3430317d070000000008687474702f312e31d07c07000000007b226d657373616765223a22556e617574686f72697a6564222c22737461747573436f6465223a3430317d070000000008687474702f312e31d07c070000000008687474702f312e31ffffff0600000008687474702f312e310000000000000008687474702f312e31777d070000000008687474702f312e31d07c070000000008687474702f312e31d07c070000000008687474702f312e31086a070000000008687474702f312e31767d070000000008687474702f312e310000000200000008687474702f312e310000008023010808687474702f312e31d17c070000000008687474702f312e31d17c070000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000800000008687474702f312e310000000000000008687474702f312e3100000000000000d9d9f7bf66737461747573677265706c696564657265706c79a1636172675903a84449444c2c6c02eff6bf920378999ea9b309016d026c02d6a9bbae0a788effd6e90e036b119df7d04004d1faff4306c2bac9970207fcb88b840308b0ced184030de8f8f49f040fccdbefb40411d8ba9be80412ee939c930513828eb9d10519dfabeef80a1dabe699aa0b1ef6c1a7a00c13c7b2fdf80c1fd89cda880d128daebbae0d2098e589a60e226c02bbada8a6077dc79898b70c056e716c08ae9db19001688fcac5b40171f1fee18d037dd7e3d9fe037d8ba5e18c0405bbada8a6077d92bfb9c607719fd5a3e909716c02c7c380ce0371a5c1bceb037d6c0982a6fca50309f88c88a7030adbc295da03058dfb97ee0405fe8d8ea90509c38daaa90809b1f3c3e50b09e1d887b30e0b91e396fd0f056e7d6e686e0c6b03edd29ab9037fe689d6fc037fe7f2ddcf087f6c0ba6fa9ac5010e8fd9aae20168f3eabee3017db6a9f6dc027182a6fca5037ddbc295da0371c38daaa90809cf8995cf0a05b1f3c3e50b7de1d887b30e0c91e396fd0f716b05d2bac9017fa4d3bb457fcbf2f8607f9980ded6077fb3d1cba00a7f6c01a0a3b29d06106c028fcac5b40171d7e3d9fe037d6c05fbca01688ba5e18c0405eaca8a9e0468fab2cafc0605d8a38ca80d7d6c01bbada8a6077d6c02a5c1bceb037ddec389dc04146c098e95ee8f0171f1fee18d037dded6aceb037daaac8d930415e3eb88d2067d99e7a4cf087def9999fe097dd5f8acd20a7d99e0a2ca0f166d7b6d176c02b891d40718b4e3ade809716d156c0192b6d2f00b1a6b02aca9e5840b1bb1e69dd60d1c6c01a5c1bceb037d6c01f88382797d6c06fbca01688fcac5b40105a5c1bceb037dedd2baf5037d8ba5e18c040588f2f7910e7d6c04ae9db19001688ba5e18c0405a0a3b29d0610d8a38ca80d7d6c02a0a3b29d0610c49ff4e40f716c088e95ee8f0171a287d4d0037da5c1bceb037deaca8a9e0468aaacd9d00678a2de94eb0621fab2cafc0605ca82b683097d6e156c03a5c1bceb037d97ccd4bd0623c2b9dbda0a256c068bb083237db2ceef2f248fcac5b40171c0febde20371bbada8a6077de3acdc850c7d6b02a39bfdac087faab0aea20e7f6d266c09b2ceef2f279efeb9a40371a287d4d0037da5c1bceb037deaca8a9e0468a2de94eb0621fab2cafc0605ca82b68309098e90efe40b716b04c2cde3db0a289ccae6a90e2ba4a1dfac0e7fb780f7c90f7f6b03a39bfdac0829eab6e99f0d2ac1f7a0eb0e2b6c028fcac5b401718dadc5c301096c038fcac5b40171edd2baf5037d88f2f7910e7d6c018fcac5b401710100b50b000000000000006a7369676e61747572657381a36974696d657374616d701b1833335c8ae145ec697369676e6174757265584051f3739785e914e0991b249d408d8b264abce0fe99f63579990225b0a0978b416f5a936e4299d187e4d82eb207c3cd2303248481d3397bad9dcd554eb6e5940c686964656e74697479581d6409b53be03e45f1152fda681d065df7a7f086668f77f56140ae91d402ff000008687474702f312e310000000000000008687474702f312e317b7d070000000008687474702f312e317b7d070000000008687474702f312e317a7d0700000000d9d9f7bf66737461747573677265706c696564657265706c79a163617267583a4449444c026b02bc8a0178c5fed201016b05a9ac8a137f9ada9099067f9cf5acb0087ffaf7f5b80b68889ad5ad0f71010000b50b0000000000006a7369676e61747572657381a36974696d657374616d701b183333e850403b7a697369676e617475726558406fda41320f54cd8ffd12b75624672417f82e50cebe2a639b302a4fd6e89a68b3b3febcc63751995afbfbeb5b57c9d8d3dc4453e1a5e4bb294b0247059d21050c686964656e74697479581db4a72a23459600a8d18398e91887c7c1b7e51bb8d4fbb45d83d9b07102ff0008687474702f312e3100000000a3000808687474702f312e317d7d070000000008687474702f312e317d7d070000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e31000000f9ffffff08687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e310000000000000008687474702f312e317d7d070000000008687474702f312e317d7d070000000064b182b0c20360347d57b5650000000008687474702f312e310000002700000008687474702f312e317e7d070000000064b539afadf4885efa49072b00000000d9d9f7bf66737461747573677265706c696564657265706c79a16361726758524449444c036e016c03dbb70102ae9db19001689685b6e204786d7b0100010c64b539afadf4885efa49072b011dad866ec8b3d57c2b65c3b4018346fd7e86ecc1186afa02a44472b26b0208000000000000006a7369676e61747572657381a36974696d657374616d701b1833350d964ee62f697369676e61747572655840c344cef8e275497eb68cf266d9078d62dbe75075a7e4854772fc2dd75f5f3ed1b62ed9d92f5853238a934626aff22d1e928fd82ef9b90b082d3d0fd9cae09206686964656e74697479581d98b572f755132129a0c0a3bc9f8b883ff39d4377b6772b187b3a4ce602ff0065c7cede9f5d6b33b3b5083c00000000d9d9f7bf66737461747573677265706c696564657265706c79a16361726758524449444c036e016c03dbb70102ae9db19001689685b6e204786d7b0100010c65c7cede9f5d6b33b3b5083c011d5f4c9f1799fa485b8a23f3ada98161a62c4030bad6123500ce05ead30209000000000000006a7369676e61747572657381a36974696d657374616d701b1833350e65e7d553697369676e617475726558405c060986c92bf0be7737d3b3de75721cc2439000e708137530bff699537e8bbfa6d3e8c7989ad611f9888f6b34623bdb2eae45f0bc7663195b36465687b6370a686964656e74697479581db2b9a58e0c5039eb36d9466a03d2a77025b32a9339d38db44d775ac802ff0064dbc0655b26ad161b9bc5c30000000067608ddeacb946241072b1de0000000064aeadd8c20360347d57a6990000000064af04c7c20360347d57aaa00000000064b82cdae205965a3950aff70000000064b6cd24adf4885efa493284ffffff7f64beba805b26ad161b9af3bd0000000065d9d6469f5d6b33b3b5119380a5000867289765ddcc7b5db7ce743700000000671a1cceddcc7b5db7ce4c4d00000000d9d9f7bf66737461747573677265706c696564657265706c79a16361726758524449444c036e016c03dbb70102ae9db19001689685b6e204786d7b0100010c671a1cceddcc7b5db7ce4c4d011d9d48479283f2072050c27b461cc6940ca055b8638f74b93e621175490226000000000000006a7369676e61747572657381a36974696d657374616d701b183335135e048763697369676e61747572655840e0fd76526f742a2e2bcb0faf343ecf9ac574cc9b75039e151836aaacd2c841c0545a363a8fcbd51d4a73ae8444decd4117d32a1c7f933d20f6e64c142e3d090c686964656e74697479581d99f298b1ffe0a09636f97cae2bd3e58e6e86d046ce0eb3a54cefc2a802ff0064c42e275b26ad161b9b24560000000064b4309badf4885efa48e950f3ffffff64afaf5fc20360347d57acfa0000000066607ea2ff6ec73e9392bf090000000067dc43aab2dde963b6b28e270000000064b44127adf4885efa48ecd20000000064ca5f035b26ad161b9b57f60000000064b5907fadf4885efa49165d0000000064af209ec20360347d57abdd0000000064af1409c20360347d57ab7b2700000064adabb6c20360347d57a3870000000064b65130adf4885efa4922740000000067228287ddcc7b5db7ce57010000000064ae5ecbc20360347d57a46c0000000064b679ffadf4885efa4927e3000000006517bc2d7cdff57f36ecbe042600000064c0bd3b5b26ad161b9b045f00000000651be1d57cdff57f36ecca05000000006728b188ddcc7b5db7ce755800000000d9d9f7a266737461747573677265706c6965646b636572746966696361746559043ed9d9f7a36474726565830183018204582038cd55954fbb167ebfcd0b9cdcdd8d07f34ff90209f4d11552894b242f57ab5b830182045820f9d21d7c5808e50b7a2680d228e60a77e493c123e48a8f751ed5cd2df7c4cb7083024e726571756573745f73746174757383018301830183018301830258200eff3deade8da62449db0653872fde8cb01b0de8633ead6fe7764df9fed0ea2e83018302457265706c79820358354449444c036b02bc8a017fc5fed201016b03faf7f5b80b68889ad5ad0f71eb9cdbd50f026c02c9b38dbc077ddfa28a930b7d0100008302467374617475738203477265706c69656482045820cb4294d3169fe422f33ab747550a18857b2c263706cadddbbb602f786a5c594082045820a951b904d8aa32d337e7a02fe06615c6a3ccbdaddc05e17fe21cc7426fb17f9e82045820e82391009c5c02de9959fadabb1edbfd934fe818182aaa74e63466770d09319c820458205d901e3c004dc2766f512eb5cb13ccb382e622f15aad55d8cc58c417cc3fd23f820458206b3dd81d34d6f3bee1c3f4543c4a836ac9975f1a6974c963dd9b6df3bee0ff44830182045820cad932e46b5d33816a53e52b1e22eea61af430c9ca84824f17e99c494038e2b983024474696d658203499d84facfcaa3cd9918697369676e617475726558308c7e7035774b99d0d536242827ad1f4f176b225ab5fd738ca72ee006d3221565d365262adb933d56b04804a4eb2cebd46a64656c65676174696f6ea2697375626e65745f6964581dfe320f2fbbb9d49c8e6edbcc9d85ec096bf645351d95bbddf556f7db026b63657274696669636174655901e5d9d9f7a2647472656583018204582077e8df685b8d6161f7da02e500b479bee67e95810c753d105a0863a5ec31c29a830183018204582057fd21c04dd900cd3ff7c5792e1c8565e08451fbe0c5af6369b01f06abb6a2a68302467375626e6574830182045820a4b59d1d3138a213fb109e093cd98ae4b02df88d858ffceae06ac05af9bc7861830182045820bf48d650418ec08cfd37bdf3706ee94ebcf48522bea8145304249cbfa4f4fb828302581dfe320f2fbbb9d49c8e6edbcc9d85ec096bf645351d95bbddf556f7db02830183024f63616e69737465725f72616e6765738203581bd9d9f781824a000000000130000001014a00000000013fffff010183024a7075626c69635f6b657982035885308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100b2a6741083996223f83384666740a3eacf8ce78c6d39fecdee582a5b243c158706bb215f396ba0429d2188df9ef176721306d048aaa58f6b413457dd63ef1a56de2378e71ca444201e29e490e3790098e92ee85e0142a33ef806c8388aec6baf83024474696d65820349e3bdb7edede6b39918697369676e61747572655830a32837aafa21d271874aeacb4fa6c36c5f5db77cea51fca5b03d5f4a09e84b2bb2ecbc517d663198d3cb258c06fcdd2e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0086a070000000090877d070000000098877d070000000098877d070000000000007d07ffffff7fc0867d070000000010857d070000000026000000270000000000000000e2010880887d070000000088887d070000000090887d070000000090887d070000000000000000000000000000000000000000a8877d0700000000000000000000000088887d07000000000000000000000000ffffffff2600000027000000dbffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0086a070000000078887d070000000080887d070000000080887d070000000000007d07ffffff7fa8877d070000000088837d070000000026000000270000000000000080e2010868897d070000000070897d070000000078897d070000000078897d07000000000000000000000000000000000000000090887d0700000000000000000000000070897d07000000000000000000000000ffffffff2600000027000000daffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0086a070000000060897d070000000068897d070000000068897d070000000000007407ffffff7f90887d0700000000e0877d070000000026000000270000000000000000e30108508a7d0700000000588a7d0700000000608a7d0700000000608a7d07000000000000000000000000000000000000000078897d07000000000000000000000000588a7d07000000000000000000000000ffffffff2600000027000000d9ffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0086a0700000000488a7d0700000000508a7d0700000000508a7d070000000000007507ffffff7f78897d0700000000d81b750700000000260000002700000070d4fe0600000000908a7d0700000000a88a7d0700000000b08a7d07000000005833750700000000f8327507000000005833750700000000f832750700000000a03275070000000030fe433a3f110000e9fd433a3f11000040fe433a3f110000e9fd433a3f11000050fe433a3f110000e9fd433a3f11000060fe433a3f110000e9fd433a3f11000070fe433a3f110000e9fd433a3f11000080fe433a3f110000e9fd433a3f1100006108000000000000';

  const input2 =
    'd9d9f7a266737461747573677265706c6965646b636572746966696361746559043ed9d9f7a36474726565830183018204582038cd55954fbb167ebfcd0b9cdcdd8d07f34ff90209f4d11552894b242f57ab5b830182045820de416b45c497d120ec86bbadfe618825bbb3b2fea1440dfdd70321acb0ab4e7d83024e726571756573745f737461747573830182045820f67f4a78e76a8533c27fccc1eb09e316280c130ade265eb1d8d92aa8baf0b2d88301830182045820e63f29190c6eda2d0e756b81b120e775d5b6d6f70b920ddc358902b156e243e483018301820458207c92dd0c21d0b38571159acae4bd57a6d5a388011ea0f996826c1d64de3d472383025820d23e167d4bcf1b745df254d84ea658a5094cc7771357d194154dd889c91268e483018302457265706c79820358354449444c036b02bc8a017fc5fed201016b03faf7f5b80b68889ad5ad0f71eb9cdbd50f026c02c9b38dbc077ddfa28a930b7d0100008302467374617475738203477265706c69656482045820fe820dd475cf006134aeecde3e604013fe719988d693673f0bf2d1f3a86f3db582045820286c2237b9ce65c55c9510e6276b272e5f4d25dc8938831020a681d06ef4c877830182045820cab2b35c1f5cf2eb619e824f35732fc3d0e7b01cf61eb1a5d69b98dce1afcc8483024474696d65820349c2c6fe9b8da4cd9918697369676e61747572655830a9c54f00c31b22db7f2cb4bfdc918a8c50c201afb221425fa08d6a8fb0bedf73422efb27bf9c42979e6ddd9c4bb2d1256a64656c65676174696f6ea2697375626e65745f6964581dfe320f2fbbb9d49c8e6edbcc9d85ec096bf645351d95bbddf556f7db026b63657274696669636174655901e5d9d9f7a264747265658301820458202b4d2ae4aa1ab47b618ed1b9d55cb139f5d75800b39342fb90559f0d16c34bb88301830182045820703cd65b21385598ecb46fd3671a9c4c8ef99d1b639dd92f2f74665f47acd43b8302467375626e6574830182045820a4b59d1d3138a213fb109e093cd98ae4b02df88d858ffceae06ac05af9bc7861830182045820c4e86f30133523379f38436fbdfcfc5bc44ec8d347667b75d88a1739028011058302581dfe320f2fbbb9d49c8e6edbcc9d85ec096bf645351d95bbddf556f7db02830183024f63616e69737465725f72616e6765738203581bd9d9f781824a000000000130000001014a00000000013fffff010183024a7075626c69635f6b657982035885308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100b2a6741083996223f83384666740a3eacf8ce78c6d39fecdee582a5b243c158706bb215f396ba0429d2188df9ef176721306d048aaa58f6b413457dd63ef1a56de2378e71ca444201e29e490e3790098e92ee85e0142a33ef806c8388aec6baf83024474696d65820349adeefb91bbe7b39918697369676e61747572655830a85f7b4bb887073d250c8fe776519d0ef40248c6ebf5b8c2fc819a7beac4643f758a5350451f4934c0f46375775359950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098f7ea060000000078386107000000001a7d542d000000000000000000000000f03b610700000000984461070000000078f3ea0600000000a03a6107000000004c6a5733000000000000000000000000a84161070000000000000000000000000000000000000000a85161070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001069038021790000903661070000000058f9ea060000000000000000000000007838610700000000ffffffffffffffff2310000000000000903661070000000098f7ea06000000000000000000000000a03a610700000000ffffffffffffffff0110000000000000430f0000b6010000603b610700000000c0386107000000004e0f000036110000903b6107000000002839610700000000540f0000ab01000028317a0700000000550f00002e000000c038610700000000d8386107000000004c0f000099080000a838610700000000e838610700000000430f0000090000000039610700000000610f0000b6010000c03b61070000000040396107000000006d0f000036010000f03b6107000000005839610700000000800f000036010000603b610700000000e8396107000000006d0f00001d0000004039610700000000903961070000000001000000010000005839610700000000890f0000ab010000e0317a0700000000890f00002e000000703961070000000098396107000000006b0f0000990800002839610700000000a839610700000000610f000009000000c039610700000000940f000036010000203c610700000000003a610700000000a90f000036010000c03b610700000000503a610700000000940f00001d000000e839610700000000383a6107000000000100000001000000003a610700000000940f000009000000183a610700000000b70f0000b6010000503c6107000000000000000000000000c40f00002b0000000000000000000000c20f000099080000503a610700000000683a610700000000b70f000009000000783a610700000000903661070000000078f3ea060000000000000000000000000000000000000000ffffffffffffffff0310000000000000000000000000000000317a070000000000000000000000003c0f000028410000000000000000000000000000ffffffff0000000003000000d03a6107000000009036610700000000403b61070000000004000000040000000000000000000000e062e7060000000000000000000000001839610700000000d839610700000000403a610700000000903a610700000000f83461070000000028317a07000000000000000000000000000000000000000048000000ffffffff8029000100000000f83461070000000050317a07000000000000000000000000000000000000000054000000ffffffff8319000000000000f83461070000000080317a0700000000000000000000000000000000000000004a000000ffffffff8029000100000000f834610700000000b8317a07000000000000000000000000000000000000000047000000ffffffff8109000100000000f83461070000000018327a07000000000000000000000000000000000000000046000000ffffffff8109000100000000f83461070000000048327a07000000000000000000000000000000000000000049000000ffffffff802900010000000000000000702f312e05000000000000000c31ad05000000000500000006000044d03a610700000000a8426107000000000100000000000000583c61070000000001008000000000006400000005000011f85b038021790000b039610700000000803d610700000000c84f6e0700000000583d610700000000d69ac94baee715bab864ad05000000004a40ad050000000019007c0000000000000000000000000001000000002f312e0000000006000000c84f6e0700000000315ff90600000000e83c61070000000000000000000000000500000007000010003d610700000000404a03802179000060000000060000100000000000000000260170220200000070b8028021790000a84f6e0700000000f83d6107000000004c93cd23e3e417a6b864ad05000000004a40ad050000000019007c0000000000000000000000000001000000000000000000000074617475a84f6e0700000000000000000000000003000000702f312e0000000000000000b83d610700000000a03d610700000000584a0380217900006400000007000010800b048021790000883f6107000000000099ad05000000001f87ad050000000036040007000000000100000001000000000000000100000002000000000000001500787400000000000000000000000000000000002f312ef0a7f7050000000001000000000000000000000008000010000000000000000060aaf70500000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000240f00000000000000000000000000000000000000000000070000000a00001110f103802179000068f203802179000005000000000000000000000000000000000000000000000003000000010000000000000000000000c8b6028021790000010000000411d8baf0f60380217900000000000000000000660000000900004f50f203802179000000f40380217900000000000000000000000000000000000000000000000000000000000000000000280e03802179000005000000000000000000000000000000400e0380217900000300000000000000000000000000000000000000000000000100000000000000e0670380217900000100808102000000640000000a000033405c038021790000483a610700000000883a610700000000e83a61070000000070dc02802179000078f502802179000088d402802179000048d5028021790000a0e1028021790000d0e30280217900000000000000000000000000000000000000416107000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b85ead05000000008d41ad05000000002a007c0700000000000000000000000001000000000000000000000000200000b8376107000000004840610700000000c043610700000000010000008f0171f148680380217900000100808102000000640000000b00001038fa028021790000b837610700000000004161070000000030f703802179000060b3e00600000000a841610700000000e2e1dc6a148e1ec8b864ad05000000004a40ad050000000019007c000000000000000000000000000100000000000000000000000000000060b3e006000000000000000000000000000000000000000000000000000000000000000000000000504161070000000001000000020000005c0000000c000010000000000000000000000000000000003867ad0500000000d641ad050000000029007c090500000000000000000000000100000000c2b9db00000000068bb083ffffffff00000000ffffffffffffffff90386107000000001850740700000000f85bad0500000000d3b478030000000032007c0001000000000000000000000001000000000000000000000000000000ffffffff00000000310fad05000000000000000000000000103f610700000000a84261070000000001000000f7c90f7f20426107000000000000000000000000030000000d00001100000000000000000000000000000000a03c610700000000504b6107000000000b00000001710100684b61070000000040540380217900000900000081a369740000000000000000804b610700000000070000001000001190b502802179000008bb02802179000005000000000000000000000000000000b04b61070000000003000000000000000000000000000000c84b6107000000000100000000000000d0416107000000000100808102000000640000000e00006670f3038021790000f83f61070000000000416107000000001069038021790000b83c610700000000f806038021790000b039610700000000c096ad05000000005685ad05000000000e0430000000000001000000000000000100000001000000000000000100000003000000000000000000000000000000c046610700000000030000008a137f9ad842610700000000e84861070000000001000000ad0f710188436107000000000000000000000000030000000f000022000000000000000000000000000000000000000000000000800603802179000078b2e006000000009844610700000000d3ac712b63f368e8b864ad05000000004a40ad050000000019007c070000000000000000000000000100000000000000000000000000000078b2e0060000000050a8f7050000000000000000000000000500000015000011c84d610700000000404461070000000001000000020000001100000010000010000000000000000010fba1f2defd5079f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000240f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f000000000000000000000000000020c502802179000003000000000000000049610700000000a8b10280217900000100000000000000f06af7050000000001020000000000000f0000001100002200000000000000000000000000000000000000000000000080c5028021790000d84f6e070000000098466107000000001e999b6113e7fe44b864ad05000000004a40ad050000000019007ce400000000000000000000000001000000000000000000000019000010d84f6e07000000000fd9cae092066869984a6107000000005801000000000000f8466107000000004046610700000000884a0380217900001100000012000010000000000000000000000000000000000000000000000000984a6107000000000300000000000000000000000000000000000000000000000100000085b6e20460aef7050000000000000000000000000f0000001300002200000000000000000000000000000000000000000000000000000000000000000000000000000000010000007381a36950a8f7050000000000000000000000000f00000014000011000000000000000000000000000000000094ad05000000008983ad05000000002204000701000000010000000100000001000000010000000200000000000000d40000001b00004401000000000000005846610700000000000000000000000098496107000000000900000000000000984a610700000000104d6107000000000700000000000000000000000000000000000000000000000500000000000000583f610700000000604c610700000000030000000005965a0000000000000000701403802179000001000000ffffff7f6047610700000000ffffffffffffffff0f000000150000550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003867ad0500000000d641ad050000000029007c070500000000000000000000000100000000ae9db100000000000000000200000000000000ffffffffffffffff9038610700000000d04e610700000000a842610700000000504b6107000000000b00000000000000684b610700000000c0426107000000000900000000000000d842610700000000804b6107000000000700000000000000984b610700000000a8b102802179000005000000000000000843610700000000b04b61070000000003000000000000002043610700000000c84b6107000000000100000000000000684861070000000001008081020000000f0000001600006600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e022038021790000030000001e0000109849610700000000e022038021790000010000000000000010a9f7050000000000000000000000000f000000170000220000000000000000000000000000000000000000000000002047610700000000000000000000000001000000c203603480a8f7050000000000000000000000000b00000018000011000000000000000000000000000000004093ad0500000000b382ad0500000000c5037c0703000000010000000100000001000000010000000000000000000000c84f6e07000000000000000000000000a840610700000000e869038021790000104d6107000000000500000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000100000000000000d0a9f7050000000000000000000000006400000019000033006a038021790000e04b61070000000080f203802179000008f20380217900003867ad0500000000d641ad050000000029007c070500000000000000000000000100000000000010000000000000000004000000de8da624ffffffffffffffff9038610700000000250170f902000000a84261070000000048b50280217900000b0000000500000160b5028021790000c0426107000000000900000000000000d84261070000000078b502802179000007000000000000000000000000000000000000000000000005000000000000000843610700000000a8b502802179000003000000000000002043610700000000c0b50280217900000100000000000000004b6107000000000100808102000000640000001a000066b04a610700000000f83f6107000000000041610700000000c069038021790000b83c610700000000f806038021790000b039610700000000104d610700000000804a6107000000000b000000f4543c4a804a610700000000604c6107000000000900000082045820804a610700000000e86903802179000007000000ca84824f0000000000000000a84c61070000000005000000facfcaa30000000000000000a8b1028021790000030000004b99d0d5000000000000000010b40280217900000100000022000044905ef705000000000102000000000000640000001b000062686a038021790000306a03802179000098070380217900000000000000000000000000000000000000000000000000000000000000000000804a6107000000000000000000000000030000000000010000000000000000000000000000000000010000000000000048adf705000000000000000000000000660000001c000022f04e610700000000806a03802179000008f20380217900000000000000000000f04e61070000000001000000093cd98a50a8f705000000000000000000000000660000001d000011984e610700000000404d610700000000305161070000000088b2e00600000000284e610700000000355597fa68c7fb4fb864ad05000000004a40ad050000000019007c07000000000000000000000000010000000003581b000000000000000088b2e006000000000500000000013fff0000000000000000e04d6107000000000300000030818230d04d610700000000804b038021790000110000001e000010000000000000000000000000000000000500000023000055884e740700000000d04b610700000000a84c610700000000b845610700000000a84c610700000000000000000000000000000000000000000300000000000000000000000000000000000000000000000100000000000000a8b0f705000000000000000000000000660000001f00004260f9038021790000884d61070000000070b30280217900000300000009e84b2b7848610700000000704d6107000000000000000000000000010000000000000080a8f7050000000000000000000000006600000020000011a86a038021790000404d610700000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000f60e000000000000240f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f000000000000420f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000003a0f0000000000005e0f0000000000005e0f0000000000005e0f0000000000005e0f0000000000005e0f000000000000820f000000000000820f000000000000820f000000000000820f000000000000820f000000000000820f000000000000fc0f000000000000fc0f000000000000fc0f000000000000fc0f000000000000fc0f000000000000fc0f0000000000009c110000000000009c110000000000009c110000000000009c110000000000009c110000000000009c11000000000000341200000000000046120000000000004612000000000000461200000000000046120000000000004612000000000000000000000000000090b2e00600000000a851610700000000aea29a960f6efd5db864ad05000000004a40ad050000000019007c000000000000000000000000000100000000000000000000000000000090b2e006000000000000000000000000c851610700000000010000000000000080a8f705000000005051610700000000984b038021790000110000002100001000000000000000008851610700000000c096ad05000000005685ad05000000000e043005000000000100000000000000010000000100001100000000010000000300000000000000284d61070000000010b40280217900000300000000000000804b61070000000078b50280217900000100000000000000d051610700000000000000000000000003000000220000220000000000000000000000000000000000000000000000004093ad0500000000da82ad0500000000c80300000300000001000000010000000100000001000000020000002f000011c84f6e070000000001000000000000000000000000000000a8e7ac05000000009889ac05000000008c00380502000000010000000100000001000000010000110000000000000000';

  const decoded1 = cbor.decode(hexToBytes(input1));
  expect(decoded1).toMatchSnapshot();

  const decoded2 = cbor.decode(hexToBytes(input2));
  expect(decoded2).toMatchSnapshot();
});
